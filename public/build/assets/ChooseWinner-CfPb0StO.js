import{c as n,o as s,a,b as u,t as r,d as k,w as $,T as E,r as c,e as C,f as m}from"./app-BIPWbP_K.js";import{_ as N}from"./AuthenticatedLayout-BheSPShh.js";import{_ as S}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-6cQn75s8.js";m.defaults.withCredentials=!0;const b={setup(){const e=c(null),t=c(!1),l=c(null),d=c(""),p=c([]),w=c(!1);let f=null;const y=async()=>{try{(await m.get("/web/contest/count")).data.count<5&&(w.value=!0)}catch{l.value="Error al validar cantidad de participantes"}},x=async()=>{var o;try{const i=await m.get("/api/contest/winner");e.value=i.data.winner,d.value=`${e.value.name} ${e.value.lastname}`}catch(i){((o=i.response)==null?void 0:o.status)!==404&&(l.value="Error al consultar el ganador existente")}},_=async()=>{var o,i;t.value=!0,l.value=null,e.value=null;try{const v=await m.get("/web/contest/clients");p.value=v.data.clients.map(h=>`${h.name} ${h.lastname}`);let g=0;f=setInterval(()=>{d.value=p.value[g%p.value.length],g++},80),setTimeout(async()=>{clearInterval(f);const h=await m.post("/web/contest/winner");e.value=h.data.winner,d.value=`${e.value.name} ${e.value.lastname}`},1e4)}catch(v){l.value=((i=(o=v.response)==null?void 0:o.data)==null?void 0:i.message)||"Error al elegir ganador"}finally{t.value=!1}};return C(()=>{y(),x()}),{winner:e,loading:t,error:l,currentName:d,startRolling:_,notEnoughParticipants:w}}};b.layout=N;const G=b,B={class:"min-h-screen bg-gradient-to-br from-blue-100 to-blue-300 flex items-center justify-center"},I={class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-2xl text-center"},P={class:"text-3xl font-bold text-blue-700 mb-6"},R={class:"h-20 mb-6 flex items-center justify-center"},j=["disabled"],T={key:0,class:"animate-spin h-5 w-5",viewBox:"0 0 24 24"},V={key:1},W={key:2},z={key:0,class:"mt-6 bg-blue-50 p-6 rounded-xl shadow-lg animate-fade-in"},M={class:"text-lg font-semibold"},q={class:"text-sm text-gray-700"},D={key:1,class:"text-red-600 mt-4"},H={key:2,class:"mt-4 text-red-600"};function A(e,t,l,d,p,w){return s(),n("div",B,[a("div",I,[a("h1",P,r(e.winner?"🏆 Ganador del Sorteo":"🎲 Seleccionando Ganador del Sorteo"),1),a("div",R,[k(E,{name:"slide",tag:"div"},{default:$(()=>[e.currentName?(s(),n("p",{key:e.currentName,class:"text-2xl font-semibold text-blue-800 animate-fade-in"},r(e.currentName),1)):u("",!0)]),_:1})]),a("button",{onClick:t[0]||(t[0]=(...f)=>e.startRolling&&e.startRolling(...f)),disabled:e.loading||e.winner||e.notEnoughParticipants,class:"bg-blue-700 text-white font-bold py-2 px-6 rounded-xl hover:bg-blue-800 transition flex items-center justify-center gap-3 disabled:opacity-50 w-full mb-6"},[e.loading?(s(),n("svg",T,t[1]||(t[1]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"white","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"white",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"},null,-1)]))):u("",!0),e.loading?(s(),n("span",W,"Seleccionando...")):(s(),n("span",V,"🎯 Seleccionar Ganador"))],8,j),e.winner?(s(),n("div",z,[t[2]||(t[2]=a("h2",{class:"text-2xl font-bold text-green-600 mb-2"},"🎉 ¡Ganador!",-1)),a("p",M,r(e.winner.name)+" "+r(e.winner.lastname),1),a("p",q,r(e.winner.city)+", "+r(e.winner.department),1)])):u("",!0),e.notEnoughParticipants?(s(),n("p",D," ⚠️ Se requieren al menos 5 participantes para realizar el sorteo. ")):u("",!0),e.error?(s(),n("p",H,r(e.error),1)):u("",!0)])])}const O=S(G,[["render",A],["__scopeId","data-v-619e62aa"]]);export{O as default};
